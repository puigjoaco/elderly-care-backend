<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Cuidadora - Mi Turno</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        /* Header con info del turno */
        .header {
            background: white;
            padding: 15px 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
        }
        .shift-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        .caregiver-name {
            font-size: 20px;
            font-weight: 600;
            color: #333;
        }
        .patient-info {
            background: #f3f4f6;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 14px;
        }
        .shift-timer {
            font-size: 24px;
            font-weight: bold;
            color: #667eea;
        }
        
        /* Container principal */
        .container {
            max-width: 1200px;
            margin: 20px auto;
            padding: 0 20px;
        }
        
        /* Check In/Out grande */
        .attendance-section {
            background: white;
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 20px;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        .attendance-status {
            display: inline-block;
            padding: 10px 20px;
            border-radius: 30px;
            font-weight: 600;
            margin-bottom: 20px;
        }
        .status-not-started {
            background: #fee2e2;
            color: #991b1b;
        }
        .status-active {
            background: #d1fae5;
            color: #065f46;
        }
        .check-btn {
            padding: 20px 40px;
            font-size: 20px;
            font-weight: 600;
            border: none;
            border-radius: 15px;
            cursor: pointer;
            color: white;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            transition: all 0.3s;
        }
        .check-in-btn {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
        }
        .check-out-btn {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
        }
        .check-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        .check-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.2);
        }
        
        /* Grid de tareas principales */
        .tasks-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        
        /* Card de tarea */
        .task-card {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        .task-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #f3f4f6;
        }
        .task-title {
            font-size: 18px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .task-icon {
            font-size: 24px;
        }
        .task-status {
            padding: 4px 12px;
            border-radius: 15px;
            font-size: 12px;
            font-weight: 600;
        }
        .status-pending {
            background: #fef3c7;
            color: #92400e;
        }
        .status-partial {
            background: #fed7aa;
            color: #92400e;
        }
        .status-complete {
            background: #d1fae5;
            color: #065f46;
        }
        .status-missed {
            background: #fee2e2;
            color: #991b1b;
        }
        
        /* Lista de items dentro de cada tarea */
        .task-items {
            list-style: none;
        }
        .task-item {
            padding: 12px;
            margin-bottom: 10px;
            background: #f9fafb;
            border-radius: 10px;
            border-left: 4px solid #e5e7eb;
            transition: all 0.3s;
        }
        .task-item.completed {
            border-left-color: #10b981;
            background: #f0fdf4;
        }
        .task-item.critical {
            border-left-color: #ef4444;
            background: #fef2f2;
        }
        .task-item.warning {
            border-left-color: #f59e0b;
            background: #fffbeb;
        }
        .item-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }
        .item-name {
            font-weight: 600;
            font-size: 15px;
        }
        .item-time {
            font-size: 14px;
            color: #6b7280;
        }
        .item-actions {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }
        
        /* Botones de acci√≥n */
        .action-btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 6px;
        }
        .btn-photo {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        .btn-done {
            background: #10b981;
            color: white;
        }
        .btn-text {
            background: #f3f4f6;
            color: #4b5563;
        }
        .btn-skip {
            background: #fbbf24;
            color: #78350f;
        }
        .action-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 10px rgba(0,0,0,0.15);
        }
        
        /* Secci√≥n de comidas */
        .meals-container {
            background: white;
            border-radius: 15px;
            padding: 20px;
        }
        .meal-item {
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 15px;
            background: #f9fafb;
            border: 2px solid transparent;
        }
        .meal-item.next {
            border-color: #667eea;
            background: #eef2ff;
        }
        .meal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        .meal-name {
            font-size: 18px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .meal-time {
            font-size: 16px;
            color: #6b7280;
        }
        .meal-status {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 10px;
        }
        .photo-preview {
            width: 80px;
            height: 80px;
            border-radius: 10px;
            object-fit: cover;
            border: 2px solid #e5e7eb;
        }
        .meal-description {
            padding: 10px;
            background: white;
            border-radius: 8px;
            margin-top: 10px;
            font-style: italic;
            color: #6b7280;
        }
        
        /* Medicamentos */
        .med-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            background: #f9fafb;
            border-radius: 10px;
            margin-bottom: 10px;
            border-left: 4px solid #e5e7eb;
        }
        .med-item.critical {
            border-left-color: #ef4444;
            background: #fef2f2;
        }
        .med-item.given {
            border-left-color: #10b981;
            background: #f0fdf4;
            opacity: 0.7;
        }
        .med-info {
            flex: 1;
        }
        .med-name {
            font-weight: 600;
            font-size: 16px;
            margin-bottom: 4px;
        }
        .med-dose {
            color: #6b7280;
            font-size: 14px;
        }
        .med-actions {
            display: flex;
            gap: 8px;
        }
        .time-badge {
            padding: 4px 12px;
            border-radius: 15px;
            font-size: 13px;
            font-weight: 600;
            background: #fef3c7;
            color: #92400e;
        }
        .time-badge.overdue {
            background: #fee2e2;
            color: #991b1b;
            animation: pulse 2s infinite;
        }
        
        /* Progress bar general */
        .daily-progress {
            background: white;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        .progress-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 15px;
        }
        .progress-items {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }
        .progress-item {
            flex: 1;
            min-width: 150px;
            text-align: center;
            padding: 15px;
            background: #f9fafb;
            border-radius: 10px;
        }
        .progress-value {
            font-size: 32px;
            font-weight: bold;
            color: #667eea;
        }
        .progress-label {
            font-size: 14px;
            color: #6b7280;
            margin-top: 5px;
        }
        .progress-bar {
            height: 8px;
            background: #e5e7eb;
            border-radius: 10px;
            overflow: hidden;
            margin-top: 10px;
        }
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #10b981 0%, #667eea 100%);
            transition: width 0.3s;
        }
        
        /* Modal para fotos y formularios */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }
        .modal.active {
            display: flex;
        }
        .modal-content {
            background: white;
            border-radius: 20px;
            padding: 30px;
            max-width: 500px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
        }
        .modal-header {
            font-size: 22px;
            font-weight: 600;
            margin-bottom: 20px;
        }
        .modal-body {
            margin-bottom: 20px;
        }
        .modal-footer {
            display: flex;
            gap: 10px;
            justify-content: flex-end;
        }
        
        /* Camera preview */
        .camera-container {
            background: #000;
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            min-height: 300px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .camera-placeholder {
            color: white;
            font-size: 48px;
        }
        
        /* Exit validation */
        .exit-checklist {
            background: #fef3c7;
            border: 2px solid #f59e0b;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
        }
        .checklist-title {
            font-weight: 600;
            margin-bottom: 15px;
            color: #92400e;
        }
        .checklist-item {
            padding: 8px 0;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .checklist-icon {
            font-size: 20px;
        }
        .checklist-item.complete {
            color: #065f46;
        }
        .checklist-item.incomplete {
            color: #991b1b;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .tasks-grid {
                grid-template-columns: 1fr;
            }
            .header-content {
                flex-direction: column;
                text-align: center;
            }
        }
    </style>
</head>
<body>
    <!-- Header con informaci√≥n del turno -->
    <div class="header">
        <div class="header-content">
            <div class="shift-info">
                <div>
                    <div class="caregiver-name">üë©‚Äç‚öïÔ∏è Siomara Gonz√°lez</div>
                    <div style="font-size: 14px; color: #6b7280;">Turno: 9:00 AM - 8:00 PM</div>
                </div>
                <div class="patient-info">
                    üëµ Mi Madre - 78 a√±os
                </div>
            </div>
            <div class="shift-timer" id="shift-timer">
                ‚è±Ô∏è 03:45:22
            </div>
        </div>
    </div>

    <div class="container">
        <!-- SECCI√ìN DE ASISTENCIA (Check In/Out) -->
        <div class="attendance-section">
            <div class="attendance-status status-active" id="attendance-status">
                ‚úÖ TURNO ACTIVO - Entrada: 9:02 AM
            </div>
            
            <button class="check-btn check-in-btn" id="check-in-btn" style="display:none;" onclick="checkIn()">
                üìç MARCAR ENTRADA
            </button>
            
            <button class="check-btn check-out-btn" id="check-out-btn" onclick="validateExit()">
                üö™ MARCAR SALIDA
            </button>
            
            <div style="margin-top: 15px; color: #6b7280; font-size: 14px;">
                üìç Ubicaci√≥n verificada: 15m de la casa
            </div>
        </div>

        <!-- PROGRESO DIARIO -->
        <div class="daily-progress">
            <div class="progress-title">üìä Progreso del D√≠a</div>
            <div class="progress-items">
                <div class="progress-item">
                    <div class="progress-value">3/4</div>
                    <div class="progress-label">Comidas</div>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: 75%"></div>
                    </div>
                </div>
                <div class="progress-item">
                    <div class="progress-value">2/3</div>
                    <div class="progress-label">Medicinas</div>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: 66%"></div>
                    </div>
                </div>
                <div class="progress-item">
                    <div class="progress-value">75.5</div>
                    <div class="progress-label">Peso (kg)</div>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: 100%"></div>
                    </div>
                </div>
                <div class="progress-item">
                    <div class="progress-value">85%</div>
                    <div class="progress-label">Completado</div>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: 85%"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- GRID DE TAREAS -->
        <div class="tasks-grid">
            <!-- MEDICAMENTOS -->
            <div class="task-card">
                <div class="task-header">
                    <div class="task-title">
                        <span class="task-icon">üíä</span>
                        Medicamentos
                    </div>
                    <div class="task-status status-partial">2/3 dados</div>
                </div>
                
                <div class="med-item critical">
                    <div class="med-info">
                        <div class="med-name">‚ö†Ô∏è Escitalopram</div>
                        <div class="med-dose">10mg (media pastilla)</div>
                    </div>
                    <div class="med-actions">
                        <span class="time-badge overdue">8:00 AM - ATRASADO</span>
                        <button class="action-btn btn-photo" onclick="takeMedPhoto('escitalopram')">
                            üì∑ Foto
                        </button>
                    </div>
                </div>
                
                <div class="med-item given">
                    <div class="med-info">
                        <div class="med-name">‚úÖ Memantine</div>
                        <div class="med-dose">20mg - Dado 2:00 PM</div>
                    </div>
                    <img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGNpcmNsZSBjeD0iMjAiIGN5PSIyMCIgcj0iMTgiIGZpbGw9IiMxMGI5ODEiLz48cGF0aCBkPSJNMTMgMjBsNCA0IDktOSIgc3Ryb2tlPSJ3aGl0ZSIgc3Ryb2tlLXdpZHRoPSIzIiBmaWxsPSJub25lIi8+PC9zdmc+" class="photo-preview">
                </div>
                
                <div class="med-item">
                    <div class="med-info">
                        <div class="med-name">Vitamina D</div>
                        <div class="med-dose">1000 UI</div>
                    </div>
                    <div class="med-actions">
                        <span class="time-badge">8:00 PM</span>
                        <button class="action-btn btn-photo" onclick="takeMedPhoto('vitamina-d')">
                            üì∑ Foto
                        </button>
                    </div>
                </div>
            </div>

            <!-- COMIDAS -->
            <div class="task-card">
                <div class="task-header">
                    <div class="task-title">
                        <span class="task-icon">üçΩÔ∏è</span>
                        Comidas del D√≠a
                    </div>
                    <div class="task-status status-partial">3/4 registradas</div>
                </div>
                
                <div class="meal-item">
                    <div class="meal-header">
                        <div class="meal-name">‚òï Desayuno</div>
                        <div class="meal-time">‚úÖ 8:30 AM</div>
                    </div>
                    <div class="meal-status">
                        <img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iODAiIGhlaWdodD0iODAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHJlY3Qgd2lkdGg9IjgwIiBoZWlnaHQ9IjgwIiBmaWxsPSIjZjNmNGY2Ii8+PHRleHQgeD0iNDAlIiB5PSI1MCUiIGZvbnQtZmFtaWx5PSJBcmlhbCIgZm9udC1zaXplPSIxNCIgZmlsbD0iIzZiNzI4MCIgdGV4dC1hbmNob3I9Im1pZGRsZSI+Rm90bzwvdGV4dD48L3N2Zz4=" class="photo-preview">
                        <div style="flex:1;">
                            <div style="font-weight:600;">Completo</div>
                            <div style="font-size:14px; color:#6b7280;">Avena, fruta, t√©</div>
                        </div>
                    </div>
                </div>
                
                <div class="meal-item">
                    <div class="meal-header">
                        <div class="meal-name">ü•ò Almuerzo</div>
                        <div class="meal-time">‚úÖ 1:00 PM</div>
                    </div>
                    <div class="meal-status">
                        <img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iODAiIGhlaWdodD0iODAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHJlY3Qgd2lkdGg9IjgwIiBoZWlnaHQ9IjgwIiBmaWxsPSIjZjNmNGY2Ii8+PHRleHQgeD0iNDAlIiB5PSI1MCUiIGZvbnQtZmFtaWx5PSJBcmlhbCIgZm9udC1zaXplPSIxNCIgZmlsbD0iIzZiNzI4MCIgdGV4dC1hbmNob3I9Im1pZGRsZSI+Rm90bzwvdGV4dD48L3N2Zz4=" class="photo-preview">
                        <div style="flex:1;">
                            <div style="font-weight:600;">Completo</div>
                            <div style="font-size:14px; color:#6b7280;">Pollo, arroz, ensalada</div>
                        </div>
                    </div>
                </div>
                
                <div class="meal-item next">
                    <div class="meal-header">
                        <div class="meal-name">‚òï Once</div>
                        <div class="meal-time">‚è∞ 5:00 PM</div>
                    </div>
                    <div class="item-actions">
                        <button class="action-btn btn-photo" onclick="takeMealPhoto('once')">
                            üì∑ Tomar Foto
                        </button>
                        <button class="action-btn btn-text" onclick="addMealText('once')">
                            ‚úèÔ∏è Sin foto
                        </button>
                    </div>
                </div>
                
                <div class="meal-item">
                    <div class="meal-header">
                        <div class="meal-name">üçΩÔ∏è Cena</div>
                        <div class="meal-time">‚è∞ 7:30 PM</div>
                    </div>
                    <div class="meal-status">
                        <div class="meal-description">
                            üìù Olvid√© foto: Sopa de verduras con pan integral
                        </div>
                    </div>
                    <div class="item-actions">
                        <button class="action-btn btn-photo" onclick="takeMealPhoto('cena')">
                            üì∑ Agregar Foto
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- OTRAS TAREAS -->
        <div class="task-card">
            <div class="task-header">
                <div class="task-title">
                    <span class="task-icon">üìã</span>
                    Tareas Diarias
                </div>
                <div class="task-status status-partial">4/6</div>
            </div>
            
            <ul class="task-items">
                <li class="task-item completed">
                    <div class="item-header">
                        <div class="item-name">‚úÖ Peso diario</div>
                        <div class="item-time">75.5 kg</div>
                    </div>
                </li>
                
                <li class="task-item completed">
                    <div class="item-header">
                        <div class="item-name">‚úÖ Presi√≥n arterial</div>
                        <div class="item-time">120/80</div>
                    </div>
                </li>
                
                <li class="task-item warning">
                    <div class="item-header">
                        <div class="item-name">‚ö†Ô∏è Ba√±o/Higiene</div>
                        <div class="item-time">Pendiente</div>
                    </div>
                    <div class="item-actions">
                        <button class="action-btn btn-done" onclick="markTaskDone('hygiene')">
                            ‚úÖ Marcar Hecho
                        </button>
                    </div>
                </li>
                
                <li class="task-item">
                    <div class="item-header">
                        <div class="item-name">Ejercicios</div>
                        <div class="item-time">3:00 PM</div>
                    </div>
                    <div class="item-actions">
                        <button class="action-btn btn-done" onclick="markTaskDone('exercise')">
                            ‚úÖ Hecho
                        </button>
                        <button class="action-btn btn-skip" onclick="skipTask('exercise')">
                            ‚è≠Ô∏è No se pudo
                        </button>
                    </div>
                </li>
            </ul>
        </div>
    </div>

    <!-- MODAL VALIDACI√ìN DE SALIDA -->
    <div class="modal" id="exit-modal">
        <div class="modal-content">
            <div class="modal-header">
                üö™ Validaci√≥n para Salir
            </div>
            <div class="modal-body">
                <div class="exit-checklist">
                    <div class="checklist-title">‚ö†Ô∏è Tareas pendientes antes de salir:</div>
                    <div class="checklist-item incomplete">
                        <span class="checklist-icon">‚ùå</span>
                        <span>Medicamento: Escitalopram (CR√çTICO)</span>
                    </div>
                    <div class="checklist-item incomplete">
                        <span class="checklist-icon">‚ùå</span>
                        <span>Foto de la Once</span>
                    </div>
                    <div class="checklist-item incomplete">
                        <span class="checklist-icon">‚ùå</span>
                        <span>Cuestionario de salida</span>
                    </div>
                    <div class="checklist-item complete">
                        <span class="checklist-icon">‚úÖ</span>
                        <span>Peso diario registrado</span>
                    </div>
                </div>
                
                <p style="margin-top:15px; color:#6b7280;">
                    Puedes marcar las tareas faltantes como "No realizadas" si no pudiste completarlas,
                    pero debes agregar una explicaci√≥n.
                </p>
            </div>
            <div class="modal-footer">
                <button class="action-btn btn-text" onclick="closeModal('exit-modal')">
                    Cancelar
                </button>
                <button class="action-btn btn-photo" onclick="completePendingTasks()">
                    Completar Pendientes
                </button>
                <button class="action-btn btn-skip" onclick="forceExit()">
                    Salir con Pendientes
                </button>
            </div>
        </div>
    </div>

    <!-- MODAL C√ÅMARA -->
    <div class="modal" id="camera-modal">
        <div class="modal-content">
            <div class="modal-header" id="camera-title">
                üì∑ Tomar Foto
            </div>
            <div class="modal-body">
                <div class="camera-container">
                    <div class="camera-placeholder">üì∑</div>
                </div>
                <p style="text-align:center; margin-top:15px; color:#ef4444; font-weight:600;">
                    ‚ö†Ô∏è SOLO C√ÅMARA - No se permite galer√≠a
                </p>
                <p style="text-align:center; margin-top:10px; color:#6b7280;">
                    La foto debe ser tomada AHORA (m√°ximo 60 segundos)
                </p>
            </div>
            <div class="modal-footer">
                <button class="action-btn btn-text" onclick="closeModal('camera-modal')">
                    Cancelar
                </button>
                <button class="action-btn btn-photo" onclick="capturePhoto()">
                    üì∏ Capturar
                </button>
            </div>
        </div>
    </div>

    <!-- MODAL TEXTO (cuando no hay foto) -->
    <div class="modal" id="text-modal">
        <div class="modal-content">
            <div class="modal-header" id="text-title">
                ‚úèÔ∏è Descripci√≥n sin foto
            </div>
            <div class="modal-body">
                <p style="margin-bottom:15px; color:#6b7280;">
                    Si olvidaste tomar la foto, describe detalladamente lo que comi√≥:
                </p>
                <textarea id="meal-description" style="width:100%; height:120px; padding:10px; border:2px solid #e5e7eb; border-radius:8px; font-size:16px;" placeholder="Ejemplo: Sopa de verduras con pollo, arroz integral, ensalada de lechuga y tomate, jugo de naranja natural"></textarea>
                <p style="margin-top:10px; color:#ef4444; font-size:14px;">
                    ‚ö†Ô∏è Recuerda: Las fotos son obligatorias. Esta opci√≥n es solo para emergencias.
                </p>
            </div>
            <div class="modal-footer">
                <button class="action-btn btn-text" onclick="closeModal('text-modal')">
                    Cancelar
                </button>
                <button class="action-btn btn-done" onclick="saveMealText()">
                    ‚úÖ Guardar
                </button>
            </div>
        </div>
    </div>

    <script>
        // Timer del turno
        let shiftStartTime = new Date();
        shiftStartTime.setHours(9, 0, 0);
        
        function updateShiftTimer() {
            const now = new Date();
            const elapsed = Math.floor((now - shiftStartTime) / 1000);
            const hours = Math.floor(elapsed / 3600);
            const minutes = Math.floor((elapsed % 3600) / 60);
            const seconds = elapsed % 60;
            
            document.getElementById('shift-timer').textContent = 
                `‚è±Ô∏è ${hours.toString().padStart(2,'0')}:${minutes.toString().padStart(2,'0')}:${seconds.toString().padStart(2,'0')}`;
        }
        
        setInterval(updateShiftTimer, 1000);
        
        // Check In
        async function checkIn() {
            if (!navigator.geolocation) {
                alert('‚ùå Tu dispositivo no soporta geolocalizaci√≥n');
                return;
            }
            
            navigator.geolocation.getCurrentPosition(async (position) => {
                // Verificar distancia (simulado)
                const distance = Math.random() * 50; // Demo
                
                if (distance > 30) {
                    alert(`‚ùå Est√°s a ${distance.toFixed(0)}m de la casa. Debes estar a menos de 30m.`);
                    return;
                }
                
                // Aqu√≠ se tomar√≠a la selfie obligatoria
                alert('üì∏ Por favor toma una selfie con el paciente');
                
                // Simular check-in exitoso
                document.getElementById('check-in-btn').style.display = 'none';
                document.getElementById('check-out-btn').style.display = 'inline-flex';
                document.getElementById('attendance-status').className = 'attendance-status status-active';
                document.getElementById('attendance-status').textContent = `‚úÖ TURNO ACTIVO - Entrada: ${new Date().toLocaleTimeString()}`;
            });
        }
        
        // Validar salida
        function validateExit() {
            // Verificar tareas pendientes
            const pendingTasks = [];
            
            // Verificar medicamentos cr√≠ticos
            // Verificar fotos de comidas
            // Verificar cuestionario
            
            document.getElementById('exit-modal').classList.add('active');
        }
        
        // Tomar foto de medicamento
        function takeMedPhoto(medName) {
            document.getElementById('camera-title').textContent = `üì∑ Foto de ${medName}`;
            document.getElementById('camera-modal').classList.add('active');
        }
        
        // Tomar foto de comida
        function takeMealPhoto(mealName) {
            document.getElementById('camera-title').textContent = `üì∑ Foto de ${mealName}`;
            document.getElementById('camera-modal').classList.add('active');
        }
        
        // Agregar texto cuando no hay foto
        function addMealText(mealName) {
            document.getElementById('text-title').textContent = `‚úèÔ∏è Descripci√≥n de ${mealName}`;
            document.getElementById('text-modal').classList.add('active');
        }
        
        // Guardar descripci√≥n de comida
        function saveMealText() {
            const description = document.getElementById('meal-description').value;
            if (!description) {
                alert('‚ùå Debes describir qu√© comi√≥');
                return;
            }
            
            alert('‚úÖ Descripci√≥n guardada. Recuerda que las fotos son obligatorias.');
            closeModal('text-modal');
            
            // Actualizar UI
            location.reload(); // En producci√≥n, actualizar solo el elemento
        }
        
        // Capturar foto (simulado)
        function capturePhoto() {
            // En producci√≥n, aqu√≠ se abrir√≠a la c√°mara nativa
            // y se validar√≠a que sea en tiempo real
            
            alert('üì∏ Foto capturada y validada (< 60 segundos)');
            closeModal('camera-modal');
            
            // Actualizar UI
            location.reload(); // En producci√≥n, actualizar solo el elemento
        }
        
        // Marcar tarea como hecha
        function markTaskDone(taskName) {
            alert(`‚úÖ ${taskName} marcado como completado`);
            // Actualizar UI
        }
        
        // Saltar tarea
        function skipTask(taskName) {
            const reason = prompt('‚ùì ¬øPor qu√© no se pudo realizar?');
            if (reason) {
                alert(`‚è≠Ô∏è ${taskName} saltado. Raz√≥n: ${reason}`);
            }
        }
        
        // Completar tareas pendientes
        function completePendingTasks() {
            closeModal('exit-modal');
            alert('üìã Por favor completa las tareas pendientes antes de salir');
        }
        
        // Forzar salida con pendientes
        function forceExit() {
            const reason = prompt('‚ö†Ô∏è Explica por qu√© debes salir con tareas pendientes:');
            if (reason) {
                alert('üö™ Salida registrada con observaciones. Se notificar√° a la familia.');
                // Aqu√≠ se completar√≠a el cuestionario obligatorio
                window.location.href = '/questionnaire.html';
            }
        }
        
        // Cerrar modal
        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('active');
        }
        
        // Notificaciones autom√°ticas de medicamentos
        function checkMedicationAlerts() {
            const now = new Date();
            const currentTime = `${now.getHours().toString().padStart(2,'0')}:${now.getMinutes().toString().padStart(2,'0')}`;
            
            // Verificar horarios de medicamentos
            // Si es hora, mostrar alerta
        }
        
        setInterval(checkMedicationAlerts, 60000); // Cada minuto
    </script>
</body>
</html>